common:
  speed:
    slowly: &SLOWLY
      speed: 0.1
      accel: 0.1
      timeout: 10
    normally: &NORMALLY
      speed: 0.4
      accel: 0.4
      timeout: 6.
    quickly: &QUICKLY
      speed: 1.
      accel: 1.
      timeout: 4.

  tolerance:
    normal_tolerance: &NORMAL_TOLERANCE
      tolerance_joints: [ 0.06, 0.006, 0.006, 0.1, 0.1, 0.1 ]
    bigger_tolerance: &BIGGER_TOLERANCE
      tolerance_joints: [ 0.01, 0.01, 0.01, 0.2, 0.2, 0.2 ]

  gripper:
    open_gripper: &OPEN_GRIPPER
      state: false
    close_gripper: &CLOSE_GRIPPER
      state: true

  arm:
    normal_home: &NORMAL_HOME
      joints: [ 0., 0.02, -0.022, -0.1566, 0., 3.14 ]
      common:
        <<: *NORMALLY
      tolerance:
        <<: *NORMAL_TOLERANCE
    stored_home: &STORE_HOME
      joints: [ 0.26, 0.01, 0., -0.348, 0., 3.14 ]
      common:
        <<: *NORMALLY
      tolerance:
        <<: *NORMAL_TOLERANCE

  gimbal:
    sky_gimbal: &SKY_POS
      frame: gimbal_base
      position: [ -0.2, -0.0008, 1 ]
    back_gimbal: &BACK_POS
      frame: gimbal_base
      position: [ -2 ,-0.1, -15 ]
    big_stone_gimbal: &BIG_STONE_POS
      frame: gimbal_base
      position: [ 2, 0.01, 0.1 ]
    walking_pos: &WALKING_POS
      frame: gimbal_base
      position: [ -2 ,0.01, -15 ]

steps_list:
  ################### COMMON STEP####################
  DELETE_SCENE:
    - step: "delete_scene"
  ################### GIMBAL ####################
  SKY_GIMBAL:
    - step: "open gripper"
      gimbal:
        <<: *SKY_POS
  WALK_GIMBAL:
    - step: "open gripper"
      gimbal:
        <<: *WALKING_POS

  BIG_STONE_GIMBAL:
    - step: "open gripper"
      gimbal:
        <<: *BIG_STONE_POS

  BACK_GIMBAL:
    - step: "gimbal"
      gimbal:
        <<: *BACK_POS

  ################### GRIPPER ####################
  OPEN_GRIPPER:
    - step: "open gripper"
      gripper:
        <<: *OPEN_GRIPPER

  CLOSE_GRIPPER:
    - step: "close gripper"
      gripper:
        <<: *CLOSE_GRIPPER
  ################### CHASSIS ####################
  CHASSIS_FORWARD:
    - step: "forward"
      chassis:
        frame: base_link
        position: [ 0.3, 0. ]
        yaw: 0.0
        chassis_tolerance_position_: 0.1
        chassis_tolerance_angular_: 0.01

  CHASSIS_BACKWARD:
    - step: "backward"
      chassis:
        frame: base_link
        position: [ -0.3, 0. ]
        yaw: 0.0
        chassis_tolerance_position_: 0.1
        chassis_tolerance_angular_: 0.01

  CHASSIS_LEFT:
    - step: "left"
      chassis:
        frame: base_link
        position: [ 0., 0.5 ]
        yaw: 0.0
        chassis_tolerance_position_: 0.1
        chassis_tolerance_angular_: 0.01

  CHASSIS_RIGHT:
    - step: "right"
      chassis:
        frame: base_link
        position: [ 0., -0.5 ]
        yaw: 0.0
        chassis_tolerance_position_: 0.1
        chassis_tolerance_angular_: 0.01

  CHASSIS_ROTATE:
    - step: "rotate"
      chassis:
        frame: base_link
        position: [ 0., 0. ]
        yaw: 3.14
        chassis_tolerance_position_: 0.1
        chassis_tolerance_angular_: 0.01
  ################### HOME ####################
  NORMAL_HOME0:
    - step: "approach"
      arm:
        <<: *NORMAL_HOME
  STORE_HOME0:
    - step: "approach"
      arm:
        <<: *STORE_HOME
  ################### HOME ####################
  ###################   READY   ################
  READY_BIG_ISLAND0:
    - step: "add the planning scene of BIG_STONE_ISLAND"
    - step: "add the planning scene of STORE_STONE"
    - step: "change gimbal's towards"
    - step: "ready state"
      arm:
        joints: [ 0.458, 0.31, 0,-1.46, 0, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
  ###################    MID    ################
  MID_BIG_ISLAND0:
    - step: "add the planning scene of BIG_STONE_ISLAND"
    - step: "add the planning scene of STORE_STONE"
    - step: "change gimbal's towards"
    - step: "ready state"
      arm:
        joints: [ 0.458, 0.31, 0,-1.44, 0, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
  MID_BIG_ISLAND00:
    - step: "add the planning scene of BIG_STONE_ISLAND"
    - step: "add the planning scene of STORE_STONE"
    - step: "change gimbal's towards"
    - step: "change gripper state"
    - step: "repeat ready state"
      arm:
        joints: [ 0.456, 0.31, 0,-1.44, 0, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *BIGGER_TOLERANCE
    - step: "move arm down to gain stone"
      arm:
        joints: [ 0.305, 0.31, 0,-1.44, 0, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
    - step: "move arm up with stone"
      arm:
        joints: [ 0.458, 0.31, 0,-1.44, 0, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
  MID_BIG_ISLAND000:
    - step: "add the planning scene of BIG_STONE_ISLAND"
      scene_name: "BIG_STONE_ISLAND"
    - step: "add the planning scene of STORE_STONE"
      scene_name: "STORE_STONE"
    - step: "change gimbal's towards"
    - step: "back to store home"
      arm:
        <<: *STORE_HOME
  ###################    LF    ################
  ###################    RT    ################

  ###################    SKY_ISLAND    ####################
  ###################   READY   ################
  READY_SKY_ISLAND0:
    - step: "add the planning scene of BIG_STONE_ISLAND"
    - step: "add the planning scene of STORE_STONE"
    - step: "change gimbal's towards"
    - step: "ready state"
      arm:
        joints: [ 0.458, 0.31, 0,-1.46, 0, 0 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
  ###################    MID    ################
  MID_SKY_ISLAND0:
    - step: "add the planning scene of BIG_STONE_ISLAND"
    - step: "add the planning scene of STORE_STONE"
    - step: "change gimbal's towards"
    - step: "ready state"
      arm:
        joints: [ 0.458, 0.31, 0,-1.44, 0, 0 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
  MID_SKY_ISLAND00:
    - step: "add the planning scene of BIG_STONE_ISLAND"
      scene_name: "BIG_STONE_ISLAND"
    - step: "add the planning scene of STORE_STONE"
      scene_name: "STORE_STONE"
    - step: "change gimbal's towards"
    - step: "back to store home"
      arm:
        <<: *STORE_HOME
    ###################    LF    ################
    ###################    RT    ################

  ###################    GAIN_STORE_STONE    ####################
  GAIN_STORE_STONE0:
    - step: "ready state"
      arm:
        joints: [ 0.2, 0.165, 0,-0.07, 0.1914, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
    - step: "move joint2 backward"
      arm:
        joints: [ 0.2, 0.06, 0,-0.07, 0.1914, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
    - step: "ready state"
      arm:
        joints: [ 0.31, 0.06, 0,-0.87, 0.1914, 3.14 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *NORMAL_TOLERANCE

    ###################    EXCHANGE    ####################
    ################### GROUND_STONE ####################
    - step: "ground"
      arm:
        joints: [ 0., 0.06, 0,-0.07, 0, 0 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *NORMAL_TOLERANCE

    ################### STORE_STONE ####################
    - step: "ground"
      arm:
        joints: [ 0.313, 0.06, 0,-1.25, 0, 3.14 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *NORMAL_TOLERANCE
    - step: "ground"
      arm:
        joints: [ 0.313, 0.01, 0,-0.174, 0, 3.14 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *NORMAL_TOLERANCE

  ###################    SMALL_ISLAND    ####################
  SMALL_ISLAND0:
    - step: "add the planning scene of BIG_STONE_ISLAND"
    - step: "add the planning scene of STORE_STONE"
    - step: "change gimbal's towards"
    - step: "ready state"
      arm:
        joints: [ 0.458, 0.31, 0,-1.44, 0, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
  SMALL_ISLAND00:
    - step: "add the planning scene of BIG_STONE_ISLAND"
    - step: "add the planning scene of STORE_STONE"
    - step: "change gimbal's towards"
    - step: "change gripper state"
    - step: "repeat ready state"
      arm:
        joints: [ 0.456, 0.31, 0,-1.44, 0, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *BIGGER_TOLERANCE
    - step: "move arm down to gain stone"
      arm:
        joints: [ 0.305, 0.31, 0,-1.44, 0, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
    - step: "move arm up with stone"
      arm:
        joints: [ 0.458, 0.31, 0,-1.44, 0, 3.14 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
  SMALL_ISLAND000:
    - step: "add the planning scene of BIG_STONE_ISLAND"
      scene_name: "BIG_STONE_ISLAND"
    - step: "add the planning scene of STORE_STONE"
      scene_name: "STORE_STONE"
    - step: "change gimbal's towards"
    - step: "back to store home"
      arm:
        <<: *STORE_HOME