common:
  speed:
    slowly: &SLOWLY
      speed: 0.1
      accel: 0.1
      timeout: 10.
    normally: &NORMALLY
      speed: 0.4
      accel: 0.4
      timeout: 6.
    quickly: &QUICKLY
      speed: 0.7
      accel: 0.7
      timeout: 4.

  tolerance:
    normal_tolerance: &NORMAL_TOLERANCE
      tolerance_joints: [ 0.06, 0.006, 0.006, 0.01, 0.01, 0.01 ]
    bigger_tolerance: &BIGGER_TOLERANCE
      tolerance_joints: [ 0.01, 0.01, 0.01, 0.2, 0.2, 0.2 ]

  gripper:
    open_gripper: &OPEN_GRIPPER
      state: false
    close_gripper: &CLOSE_GRIPPER
      state: true

  arm:
    normal_home: &NORMAL_HOME
      joints: [ 0., 0.02,  0.007, -0.1566, 0., 3.14 ]
      common:
        <<: *NORMALLY
      tolerance:
        <<: *NORMAL_TOLERANCE
    stored_home: &STORE_HOME
      joints: [ 0.26, 0.01, 0., -0.348, 0., 3.14 ]
      common:
        <<: *NORMALLY
      tolerance:
        <<: *NORMAL_TOLERANCE
    pick_wait: &PICK_WAIT
      frame: base_link
      position: [ 0.283, 0.225, 0.836 ]
      rpy: [ -2.15,-1.560,-2.538 ]
      common:
        <<: *NORMALLY

  gimbal:
    sky_gimbal: &SKY_POS
      frame: gimbal_base
      position: [ -0.2, -0.0008, 1 ]
    back_gimbal: &BACK_POS
      frame: gimbal_base
      position: [ -2 ,-0.1, -15 ]
    big_stone_gimbal: &BIG_STONE_POS
      frame: gimbal_base
      position: [ 2, 0.01, 0.1 ]
    walking_pos: &WALKING_POS
      frame: gimbal_base
      position: [ -2 ,0.01, -15 ]

steps_list:
  ################### COMMON STEP####################
  DELETE_SCENE:
    - step: "delete_scene"
  ################### GIMBAL ####################
  SKY_GIMBAL:
    - step: "open gripper"
      gimbal:
        <<: *SKY_POS
  WALK_GIMBAL:
    - step: "open gripper"
      gimbal:
        <<: *WALKING_POS

  BIG_STONE_GIMBAL:
    - step: "open gripper"
      gimbal:
        <<: *BIG_STONE_POS

  BACK_GIMBAL:
    - step: "gimbal"
      gimbal:
        <<: *BACK_POS

  ################### GRIPPER ####################
  OPEN_GRIPPER:
    - step: "open gripper"
      gripper:
        <<: *OPEN_GRIPPER

  CLOSE_GRIPPER:
    - step: "close gripper"
      gripper:
        <<: *CLOSE_GRIPPER
  ################### CHASSIS ####################
  CHASSIS_FORWARD:
    - step: "forward"
      chassis:
        frame: base_link
        position: [ 0.3, 0. ]
        yaw: 0.0
        chassis_tolerance_position_: 0.025
        chassis_tolerance_angular_: 0.1

  CHASSIS_BACKWARD:
    - step: "backward"
      chassis:
        frame: base_link
        position: [ -0.1, 0. ]
        yaw: 0.0
        chassis_tolerance_position_: 0.025
        chassis_tolerance_angular_: 0.1

  CHASSIS_LEFT:
    - step: "left"
      chassis:
        frame: base_link
        position: [ 0., 0.5 ]
        yaw: 0.0
        chassis_tolerance_position_: 0.1
        chassis_tolerance_angular_: 0.01

  CHASSIS_RIGHT:
    - step: "right"
      chassis:
        frame: base_link
        position: [ 0., -0.5 ]
        yaw: 0.0
        chassis_tolerance_position_: 0.1
        chassis_tolerance_angular_: 0.01

  CHASSIS_ROTATE:
    - step: "rotate"
      chassis:
        frame: base_link
        position: [ 0., 0. ]
        yaw: 3.14
        chassis_tolerance_position_: 0.1
        chassis_tolerance_angular_: 0.01

  ################### CHASSIS ####################
  ARM_RIGHT1:
    - step: "forward"
      servo:
        frame: tools_link
        position: [ 0., 0.,   0. ]
        orientation: [ 0., 0., 0. ]
        servo_tolerance_position: 0.06
        servo_tolerance_angular: 0.1

  ################### HOME ####################

  HOME0:
    - step: "home with no stone"
      arm:
        <<: *NORMAL_HOME
  HOME1:
    - step: "home with one stone"
      arm:
        <<: *NORMAL_HOME
  HOME2:
    - step: "home with two stone"
      arm:
        <<: *NORMAL_HOME


  ################### GROUND ####################
  GROUND_STONE0:
    - step: "ground"
      arm:
        joints: [ 0., 0.02,  0.007, -0.05, 0., 0. ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE

  ###################    SKY_BIG_ISLAND    ####################
  SKY_BIG_ISLAND0:
    - step: "arm_wait"
      arm:
        <<: *PICK_WAIT
  SKY_BIG_ISLAND00:
    - step: "up"
      arm:
        joints: [ 0.435, 0.266, 0.007, -1.496, -0.005, 0 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
  SKY_BIG_ISLAND000:
    - step: "arm_wait"
      arm:
        <<: *PICK_WAIT
    ###################    BIG_ISLAND    ####################
    ###################    MID    ################
  BIG_ISLAND0:
    - step: "arm_wait"
      arm:
        <<: *PICK_WAIT
  BIG_ISLAND00:
    - step: "add scenes"
      scene_name: MID_BIG_ISLAND
    - step: "arm_ready"
      arm:
        frame: base_link
        position: [ 0.743, 0.007, 0.748 ]
        rpy: [ -0.555,1.539, 2.581 ]
        common:
          <<: *NORMALLY
        tolerance_position: 0.001
    - step: "change gripper state"
    - step: "delete_scene"
  BIG_ISLAND000:
    - step: "get stone"
      arm:
        joints: [ 0.299, 0.266, 0.007, -1.526, -0.005, 3.119 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
    - step: "up"
      arm:
        joints: [ 0.435, 0.266, 0.007, -1.496, -0.005, 3.119 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *NORMAL_TOLERANCE
    - step: "reversal"
      arm:
        joints: [ 0.433, 0.042, 0.007, -1.502, -0.001, 0.014 ]
        common:
          <<: *NORMALLY
        tolerance:
          <<: *BIGGER_TOLERANCE
    - step: "move to wait "
      arm:
        frame: base_link
        position: [ 0.283, 0.225, 0.836 ]
        rpy: [ -2.15,-1.560,-2.538 ]
        common:
          <<: *SLOWLY
  ###################    SMALL_ISLAND    ####################
  LF_SMALL_ISLAND0:
    - step: "arm_wait"
      arm:
        <<: *PICK_WAIT
      gripper:
        <<: *CLOSE_GRIPPER
  LF_SMALL_ISLAND00:
    - step: "add scenes"
      scene_name: MID_SMALL_ISLAND
    - step: "arm_ready"
      arm:
        frame: base_link
        position: [ 0.507, 0.265, 0.722 ]
        rpy: [ -0.649,1.506, 2.485 ]
        common:
          <<: *NORMALLY
        tolerance_position: 0.001
    - step: "change gripper state"
      gripper:
        <<: *OPEN_GRIPPER
    - step: "delete_scene"
  LF_SMALL_ISLAND000:
    - step: "move arm down to gain stone"
      arm:
        frame: base_link
        position: [ 0.507, 0.265, 0.6401 ]
        rpy: [ -0.750,1.510, 2.383 ]
        common:
          <<: *QUICKLY
        tolerance_position: 0.01
    - step: "move arm up with stone and go right"
      arm:
        frame: base_link
        position: [ 0.504, 0.265, 0.811 ]
        rpy: [ -0.330, 1.441, 2.809 ]
        common:
          <<: *NORMALLY
        tolerance_position: 0.001
    - step: "go right"
      arm:
        frame: base_link
        position: [ 0.506, 0.209, 0.812 ]
        rpy: [ -0.331, 1.439, 2.815 ]
        common:
          <<: *NORMALLY
        tolerance_position: 0.001
    - step: "reversal"
      arm:
        frame: base_link
        position: [ 0.506, 0.209, 0.811 ]
        rpy: [ 0.042,-1.443, -0.033 ]
        common:
          <<: *NORMALLY
        tolerance_position: 0.001
  LF_SMALL_ISLAND0000:
    - step: "move to wait "
      arm:
        frame: base_link
        position: [ 0.283, 0.225, 0.836 ]
        rpy: [ -2.15,-1.560,-2.538 ]
        common:
          <<: *NORMALLY
    ###################    MID    ################
  MID_SMALL_ISLAND0:
    - step: "arm_wait"
      arm:
        <<: *PICK_WAIT
  MID_SMALL_ISLAND00:
    - step: "add scenes"
      scene_name: MID_SMALL_ISLAND
    - step: "arm_ready"
      arm:
        frame: base_link
        position: [ 0.507, 0.008, 0.723 ]
        rpy: [ -0.498,1.515, 2.639 ]
        common:
          <<: *NORMALLY
        tolerance_position: 0.001
    - step: "change gripper state"
    - step: "backward"
      chassis:
        frame: base_link
        position: [ -0.09, 0. ]
        yaw: 0.0
        chassis_tolerance_position_: 0.025
        chassis_tolerance_angular_: 0.1
    - step: "delete_scene"
  MID_SMALL_ISLAND000:
    - step: "up"
      arm:
        joints: [ 0.2540476892306656, 0.03155902847607778, 0.005682599990380954, -1.5497683296037037, 0.09603447921700581, 3.1295657735691975 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *BIGGER_TOLERANCE
    - step: "up"
      arm:
        joints: [ 0.2550476892306656, 0.03255902847607778, 0.005682599990380954, -1.5497683296037037, 0.09603447921700581, 3.1295657735691975 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *BIGGER_TOLERANCE
    - step: "up"
      arm:
        joints: [ 0.2560476892306656, 0.03355902847607778, 0.005682599990380954, -1.5497683296037037, 0.09603447921700581, 3.1295657735691975 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *BIGGER_TOLERANCE
    - step: "up"
      arm:
        joints: [ 0.2570476892306656, 0.03455902847607778, 0.005682599990380954, -1.5497683296037037, 0.09603447921700581, 3.1295657735691975 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *BIGGER_TOLERANCE
    - step: "up"
      arm:
        joints: [ 0.2580476892306656, 0.03555902847607778, 0.005682599990380954, -1.5497683296037037, 0.09603447921700581, 3.1295657735691975 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *BIGGER_TOLERANCE
    - step: "up"
      arm:
        joints: [ 0.2590476892306656, 0.03655902847607778, 0.005682599990380954, -1.5497683296037037, 0.09603447921700581, 3.1295657735691975 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *BIGGER_TOLERANCE
    - step: "up"
      arm:
        joints: [ 0.26000476892306656, 0.03755902847607778, 0.005682599990380954, -1.5497683296037037, 0.09603447921700581, 3.1295657735691975 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *BIGGER_TOLERANCE
    - step: "up"
      arm:
        joints: [ 0.2610476892306656, 0.03855902847607778, 0.005682599990380954, -1.5497683296037037, 0.09603447921700581, 3.1295657735691975 ]
        common:
          <<: *SLOWLY
        tolerance:
          <<: *BIGGER_TOLERANCE

    ###################    RT    ################
  RT_SMALL_ISLAND0:
    - step: "arm_wait"
      arm:
        <<: *PICK_WAIT
  RT_SMALL_ISLAND00:
    - step: "add scenes"
      scene_name: MID_SMALL_ISLAND
    - step: "arm_ready"
      arm:
        frame: base_link
        position: [ 0.507, -0.252, 0.718 ]
        rpy: [ -0.516, 1.498, 2.615 ]
        common:
          <<: *NORMALLY
        tolerance_position: 0.001
    - step: "change gripper state"
    - step: "delete_scene"
  RT_SMALL_ISLAND000:
    - step: "move arm down to gain stone"
      arm:
        frame: base_link
        position: [ 0.504, -0.250, 0.640 ]
        rpy: [ -0.524,1.502, 2.614 ]
        common:
          <<: *QUICKLY
        tolerance_position: 0.01
    - step: "move arm up with stone and go right"
      arm:
        frame: base_link
        position: [ 0.504, -0.250, 0.812 ]
        rpy: [ -0.334,1.465, 2.802 ]
        common:
          <<: *NORMALLY
        tolerance_position: 0.001
    - step: "go right"
      arm:
        frame: base_link
        position: [ 0.505, -0.290, 0.811 ]
        rpy: [ -0.328,1.464, 2.803 ]
        common:
          <<: *NORMALLY
        tolerance_position: 0.001
    - step: "reversal"
      arm:
        frame: base_link
        position: [ 0.506, -0.295, 0.806 ]
        rpy: [ -0.137,-1.467, 0.108 ]
        common:
          <<: *SLOWLY
        tolerance_position: 0.001
  RT_SMALL_ISLAND0000:
    - step: "move to wait "
      arm:
        frame: base_link
        position: [ 0.283, 0.225, 0.836 ]
        rpy: [ -2.15,-1.560,-2.538 ]
        common:
          <<: *NORMALLY
      ###################    SMALL_ISLAND    ####################

      ###################   JQ   ####################

  TEST:
    - step: "move to wait "
      auto:
        common:
        tolerance: